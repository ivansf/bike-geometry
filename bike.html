<!DOCTYPE html>
<html>
<head>
	<title></title>
</head>
<body>

<canvas id="bike-render" width="600" height="500">
	Hey!
</canvas>
<script type="text/javascript">



var Bike = (function Bike() {

	// Initial Setup
	// -------------
	
	var name, wheelSize, wheelBase, chainStay, bbHeight, seatTube, standOverHeight, seatAngle,
		headAngle, topTube, name;
	var leftSpace = 150;

	// Checks for required numbers to be present.
	// ------------------------------------------
	var requiredParts = function() {

		var valid = false;
		name.length > 0 ? valid = true : valid = false;
		// console.log(wheelSize);
		wheelSize ? valid = true : valid = false;
		// this.seatAngle > 0 ? valid = true : valid = false;
		// this.separation > 0 ? valid = true : valid = false; 
		// this.separation = 100;

		//throw "Missing separation";
		return valid;
	}

	// Renders a guide grid
	// --------------------
	var	renderGridCanvas = function(ctx) { 
		ctx.beginPath();
		ctx.strokeStyle = "rgb(120,120,120)";
		ctx.lineWidth = 0.5;
		for (var i = 0; i <= 600; i+=10) {
			ctx.moveTo(i * this.zoomFactor,0);
			ctx.lineTo(i * this.zoomFactor, 410);
		};
    	ctx.stroke();
    	return;
	}







	// ---------------------------------
	// Helpers and position calculations
	// ---------------------------------

	var bbPosition = function (ground) {
		// x should be calculated using the chainstay

		return {
				x: leftSpace + wheelBase/2 * zoomFactor,
				y: (ground - (bbHeight * zoomFactor))
			}; // random number for now
	}


	// Public Methods
	// --------------
	// 	

	// setValues()
	// 		should be called if the geometry has to be passed before it gets
	// 		rendered. This can be helpful when we just need calculations.

	return {

		setValues : function(values) {
			name = values.name;
			zoomFactor = values.zoomFactor;
			wheelSize = values.wheelSize;
			wheelBase = values.wheelBase;
			chainStay = values.chainStay;
			bbHeight = values.bbHeight;
			seatTube = values.seatTube;
			standOverHe = values.standOverHeight;
			seatAngle = values.seatAngle;
			headAngle = values.headAngle;
			topTube = values.topTube;
		},

		/**
			Renders the bike using regular Canvas.
		*/
		renderCanvas : function(canvasElement, renderGrid) {
			canvas = document.getElementById(canvasElement);
			var ctx = canvas.getContext('2d');
			// console.log(ctx);
			if (!requiredParts())  {
				console.log('Missing parts');
				return;
			}

			// var base = 250;
			var ground = 350;
			

			if (renderGrid)
				renderGridCanvas(ctx);


	  		// drawing wheels
			ctx.strokeStyle = "rgb(0,0,0)";
			ctx.lineWidth = 1;
			
			ctx.beginPath();
			ctx.arc(leftSpace, ground - (wheelSize * zoomFactor/2), wheelSize/2 * zoomFactor, 0 ,Math.PI*2, true);
			ctx.stroke();

			ctx.beginPath();
			ctx.arc(leftSpace + wheelBase * zoomFactor,  ground - (wheelSize * zoomFactor/2), wheelSize/2* zoomFactor, 0 ,Math.PI*2, true);
			ctx.stroke();

			// inner wheels
			// ctx.lineWidth = 1;
			// ctx.beginPath();
			// ctx.arc(leftSpace + wheelBase * zoomFactor,  ground - (wheelSize * zoomFactor/2), (wheelSize/2 * 0.9) * zoomFactor, 0 ,Math.PI*2, true);
			// ctx.stroke();

			// ctx.lineWidth = 1;
			// ctx.beginPath();
			// ctx.arc(leftSpace,  ground - (wheelSize * zoomFactor/2), (wheelSize * 0.9) * zoomFactor/2, 0 ,Math.PI*2, true);
			// ctx.stroke();


			// bottom bracket
			ctx.lineWidth = 1;
			ctx.beginPath();
			ctx.arc(bbPosition(ground).x, bbPosition(ground).y, 1 * zoomFactor, 0 ,Math.PI*2, true);
			ctx.stroke();


			// seat tube
			angle = 270 - 73;
			angle = angle * Math.PI / 180;
			endX = bbPosition(ground).x + (seatTube * zoomFactor) * Math.sin(angle);
			endY = bbPosition(ground).y + (seatTube * zoomFactor) * Math.cos(angle);

			ctx.lineWidth = 1;
			ctx.beginPath();
			ctx.moveTo(bbPosition(ground).x, bbPosition(ground).y); // this should the center of the BB.
			ctx.lineTo(endX, endY); // JUST made up for now.
			ctx.stroke();

		},

	}
})();


values = {
	name : "My Bike",
	zoomFactor : 5,
	wheelSize : 27.5,
	wheelBase: 43.5,
	chainStay : 0,
	bbHeight : 12,
	seatTube : 19,
	standOverHeight : 0,
	seatAngle : 0,
	headAngle : 0,
	topTube: 0
}

Bike.setValues(values);
Bike.renderCanvas("bike-render", true);

</script>

</body>
</html>